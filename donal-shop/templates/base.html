<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Donald Shop - Votre boutique en ligne{% endblock %}</title>
    <link rel="stylesheet" href="/static/css/styles.css">
</head>
<body>
    <header>
        <nav>
            <div class="logo">Donald Shop</div>
            <div class="nav-links">
                <a href="/">Accueil</a>
                <a href="/produits/">Produits</a>
                <a href="/panier/">Panier ({{ panier.nombre_articles }})</a>
                <a href="#">Cat√©gories</a>
                <a href="#">Contact</a>
            </div>
        </nav>
    </header>
    
    <main class="container">
        {% block content %}
        {% endblock %}
    </main>
    
    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3>Donald Shop</h3>
                <p>Votre boutique en ligne de confiance</p>
            </div>
            <div class="footer-section">
                <h3>Contact</h3>
                <p>Email: contact@donaldshop.com</p>
                <p>T√©l√©phone: +225 XX XX XX XX</p>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2024 Donald Shop. Tous droits r√©serv√©s.</p>
        </div>
    </footer>

        <script>
function ajouterAuPanier(produitId) {
    console.log("üîç DEBUT - Produit ID:", produitId);
    console.log("üîç URL:", `/panier/ajouter/${produitId}/`);
    
    // V√©rifier le token CSRF
    const csrfToken = getCookie('csrftoken');
    console.log("üîç CSRF Token:", csrfToken ? "‚úÖ Pr√©sent" : "‚ùå Manquant");
    
    fetch(`/panier/ajouter/${produitId}/`, {
        method: 'POST',
        headers: {
            'X-Requested-With': 'XMLHttpRequest',
            'X-CSRFToken': csrfToken
        }
    })
    .then(response => {
        console.log("üîç Statut HTTP:", response.status);
        console.log("üîç Headers:", response.headers);
        return response.json();
    })
    .then(data => {
        console.log("üîç Donn√©es re√ßues:", data);
        if(data.success) {
            const panierLink = document.getElementById('panier-link');
            if (panierLink) {
                panierLink.textContent = `Panier (${data.nombre_articles})`;
            }
            alert('‚úÖ Produit ajout√© au panier !');
        } else {
            alert('‚ùå Erreur: ' + (data.message || 'Erreur inconnue'));
        }
    })
    .catch(error => {
        console.error('üîç Erreur fetch:', error);
        alert('‚ùå Erreur r√©seau: ' + error.message);
    });
    
    console.log("üîç FIN - Requ√™te envoy√©e");
}

function getCookie(name) {
    console.log("üç™ Recherche cookie:", name);
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                console.log("üç™ Cookie trouv√©:", cookieValue ? "‚úÖ" : "‚ùå");
                break;
            }
        }
    }
    return cookieValue;
}
</script>
</body>
</html>